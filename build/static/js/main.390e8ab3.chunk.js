(this.webpackJsonpthreekingdoms=this.webpackJsonpthreekingdoms||[]).push([[0],[,,,,,,,,function(e,t,n){e.exports=n(19)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(7),c=n.n(o),r=(n(13),n(14),n(1)),s=n(2),l=n(4),u=n(3),h=n(5),m=.01,d={GAME_SELECT:1,ROLE_SELECT:2,MAIN_MAP:3,BATTLE_MAP:4,BATTLE:5,END:6},f={pool:[],findEvent:function(e){for(var t=this.pool.length-1;t>=0;t--)if(this.pool[t].name===e)return this.pool[t];return!1},uniqueCallback:function(e,t){for(var n=!1,a=0;a<e.funcs.length;a++)if(t.toString()===e.funcs[a].toString()){e.funcs[a]=t,n=!0;break}n||e.funcs.push(t)},removeEvent:function(e){for(var t=this.pool.length-1;t>=0;t--)if(this.pool[t].name===e){this.pool.splice(t,1);break}},destory:function(e){this.removeEvent.call(this,e)},off:function(e){this.removeEvent.call(this,e)},unSubscribe:function(e){this.removeEvent.call(this,e)},once:function(e,t){var n=this.findEvent(e);n?t&&n.funcs.push(t):(n={name:e,funcs:[t],isOnce:!0},this.pool.push(n))},listen:function(e,t){var n=this.findEvent(e);n?this.uniqueCallback(n,t):(n={name:e,funcs:[t],isOnce:!1},this.pool.push(n))},on:function(e,t){this.listen.call(this,e,t)},subscribe:function(e,t){this.listen.call(this,e,t)},trigger:function(e,t){var n=this.findEvent(e);n&&(n.funcs.forEach((function(e){e(t)})),n.isOnce&&this.removeEvent(e))}};function p(){this.ipcRenderer=window.require("electron").ipcRenderer}p.prototype.send=function(e,t,n){var a=this;return new Promise((function(i,o){switch(e){case"save":a.ipcRenderer.send("".concat(e,".").concat(t),n);break;case"load":a.ipcRenderer.send("".concat(e,".").concat(t));break;default:throw new Error("unrecognized event type ".concat(e))}a.ipcRenderer.once("".concat(e,".").concat(t,".complete"),(function(e,t){"string"===typeof t&&(t=JSON.parse(t)),i(t)}))}))};var g=new p;function v(){}v.prototype.getKingdoms=function(){return g.send("load","kingdoms")},v.prototype.getGenerals=function(){return g.send("load","generals")},v.prototype.getCities=function(){return g.send("load","cities")},v.prototype.getWeapons=function(){return g.send("load","weapons")},v.prototype.getArmors=function(){return g.send("load","armors")},v.prototype.getWeaponTypes=function(){return g.send("load","weaponTypes")};var E=new v;function b(e){this.id=e.id,this.name=e.name,this.isCustomized=e.isCustomized,this.capital=e.capital,this.reputation=e.reputation}b.prototype.build=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){t.id!==e.capital||(e.capital=t)}))};var w=b;function y(e){this.id=e.id,this.name=e.name,this.experience=e.experience,this.level=this.getLevel(e.experience),this.morality=e.morality,this.hp=e.hp,this.politics=e.politics,this.command=e.command,this.intelligence=e.intelligence,this.force={power:e.power,skill:e.skill,overall:this.getOverallForce(e.power,e.skill)},this.loyalty={extent:e.extent,caprice:e.caprice},this.bornYear=e.bornYear,this.deadYear=e.deadYear,this.title=e.title,this.heroType=e.heroType,this.weapon=e.weapon,this.armor=e.armor,this.isCustomized=e.isCustomized,this.isLord=e.isLord,this.ambition=e.ambition,this.aggressive=e.aggressive}y.prototype.build=function(e,t){var n=this;e.forEach((function(e){e.id!==n.weapon||(n.weapon=e)})),t.forEach((function(e){e.id!==n.armor||(n.armor=e)})),this.getMaxAllowedMilitary()},y.prototype.getMaxAllowedMilitary=function(){this.maxMilitary=1e3*Math.round(this.command/10+1)},y.prototype.getOverallForce=function(e,t){return Math.round(.43*e+.57*t)},y.prototype.getLevel=function(e){return parseInt(e/100)+1};var S=y;function A(e){this.id=e.id,this.name=e.name,this.morale=e.morale,this.treasure=e.treasure,this.generals=e.generals,this.leader=e.leader,this.development={farmland:e.farmland,industry:e.industry,infrastructure:e.infrastructure},this.military=e.military,this.militaryAmount=this.countMilitary(),this.disasterPrevention=e.disasterPrevention,this.immigration=0}A.prototype.build=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[];this.generals.length&&(t.forEach((function(t){e.generals.forEach((function(e){t.id===e&&n.push(t)})),e.leader===t.id&&(e.leader=t)})),this.generals=n),this.getPopulation()},A.prototype.getPopulation=function(){var e=10*Math.pow(.4*this.development.farmland+.1*this.development.industry+.5*this.development.infrastructure,.57);this.population=1e3*(Math.round(e)+this.immigration)},A.prototype.countMilitary=function(){return 1e4};var k=A;function O(e){this.id=e.id,this.name=e.name,this.startPoint=e.startPoint,this.power=e.power,this.category=e.category}O.prototype.build=function(e){var t=this;e.forEach((function(e){e.id===t.category&&(t.category=e)}))};var L=O;var T=function(e){this.id=e.id,this.name=e.name,this.startPoint=e.startPoint,this.power=e.power};var _=function(e){this.id=e.id,this.name=e.name};function N(){this.data=null,this.realTimeData=null,this.kingdoms=null,this.generals=null,this.cities=null,this.weapons=null,this.armors=null}N.prototype.init=function(){var e=this;this.getRawEntites().then((function(){e.getEntityInstances(),e.build()}))},N.prototype.getRawEntites=function(){var e=this;return Promise.all([E.getKingdoms(),E.getGenerals(),E.getCities(),E.getWeapons(),E.getArmors(),E.getWeaponTypes()]).then((function(t){e.kingdoms=t[0],e.generals=t[1],e.cities=t[2],e.weapons=t[3],e.armors=t[4],e.weaponTypes=t[5]}))},N.prototype.getEntityInstances=function(){var e=this;this.kingdoms.forEach((function(t,n){e.kingdoms[n]=new w(t)})),this.generals.forEach((function(t,n){e.generals[n]=new S(t)})),this.cities.forEach((function(t,n){e.cities[n]=new k(t)})),this.weapons.forEach((function(t,n){e.weapons[n]=new L(t)})),this.weaponTypes.forEach((function(t,n){e.weaponTypes[n]=new _(t)})),this.armors.forEach((function(t,n){e.armors[n]=new T(t)}))},N.prototype.build=function(){var e=this;this.weapons.forEach((function(t){t.build(e.weaponTypes)})),this.generals.forEach((function(t){t.build(e.weapons,e.armors)})),this.cities.forEach((function(t){t.build(e.generals)})),this.kingdoms.forEach((function(t){t.build(e.cities)})),console.log(this.kingdoms)};var C=new N,M=(n(15),{gameSelectScene:{GAME_TITLE:"Three Kingdoms",GAME_VERSION:"version",NEW_GAME:"New Game",LOAD_SAVED:"Load Game",LANGUAGE_SWITCHER:"Language",CN:"Chinese",EN:"English",DIFFICULT:"Difficulty",EASY:"Easy",NORMAL:"Normal",HARD:"Hard",BACK:"Back",SAVE_SLOT:"Save Slot"}}),G={gameSelectScene:{GAME_TITLE:"\u4e09\u56fd\u5fd7",GAME_VERSION:"\u7248\u672c",NEW_GAME:"\u65b0\u6e38\u620f",LOAD_SAVED:"\u8bfb\u53d6\u8fdb\u5ea6",LANGUAGE_SWITCHER:"\u5207\u6362\u8bed\u8a00",CN:"\u4e2d\u6587",EN:"\u82f1\u8bed",DIFFICULT:"\u96be\u5ea6",EASY:"\u7b80\u5355",NORMAL:"\u4e00\u822c",HARD:"\u56f0\u96be",BACK:"\u540e\u9000",SAVE_SLOT:"\u5b58\u6863"}},j={currentLanguage:"cn",content:G,set:function(e){switch(e.toLowerCase()){case"en":this.currentLanguage="en",this.content=M;break;case"cn":this.currentLanguage="cn",this.content=G;break;default:throw new Error("unrecognized language code in Language Class")}},get:function(){return this.currentLanguage}},R=(n(16),function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=j.content.gameSelectScene;return i.a.createElement("div",{className:"cp cp-game-select-banner"},i.a.createElement("h1",{className:"primary-text"},e.GAME_TITLE),i.a.createElement("span",{className:"game-version"},e.GAME_VERSION," ",m))}}]),t}(a.Component)),x=(n(17),function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_getLayout",value:function(){var e=this,t=[];return this.props.args.commands.forEach((function(n,a){t.push(i.a.createElement("li",{key:a,className:"command"},i.a.createElement("button",{"data-value":n.value,className:"command-btn ".concat(n.value),onClick:e._clickCommand.bind(e,n)},n.label)))})),t}},{key:"_clickCommand",value:function(e){f.trigger("".concat(this.props.args.eventName,".click"),e),f.trigger("".concat(this.props.args.eventName,".").concat(e.value,".click"),e)}},{key:"render",value:function(){var e=this._getLayout(),t=this.props.args.heading?i.a.createElement("h3",{className:"heading"},this.props.args.heading):"";return i.a.createElement("div",{className:"cp cp-command-box ".concat(this.props.args.eventName)},t,i.a.createElement("ul",null,e))}}]),t}(a.Component)),B=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={commandBox:"main"},n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_getCommandBox",value:function(){var e=j.content.gameSelectScene;switch(this.state.commandBox){case"main":return{eventName:"gameSelect",commands:[{label:e.NEW_GAME,value:"newGame"},{label:e.LOAD_SAVED,value:"loadGame"},{label:e.LANGUAGE_SWITCHER,value:"languageSwitcher"}]};case"newGame":return{eventName:"newGame",commands:[{label:e.EASY,value:"level1"},{label:e.NORMAL,value:"level2"},{label:e.HARD,value:"level3"},{label:e.BACK,value:"back"}]};case"loadGame":return{eventName:"loadGame",commands:[{label:"".concat(e.SAVE_SLOT," 1"),value:"save1"},{label:"".concat(e.SAVE_SLOT," 2"),value:"save2"},{label:"".concat(e.SAVE_SLOT," 3"),value:"save3"},{label:"".concat(e.SAVE_SLOT," 4"),value:"save4"},{label:"".concat(e.SAVE_SLOT," 5"),value:"save5"},{label:"".concat(e.SAVE_SLOT," 6"),value:"save6"},{label:"".concat(e.SAVE_SLOT," 7"),value:"save7"},{label:"".concat(e.SAVE_SLOT," 8"),value:"save8"}]};case"languageSwitcher":return{eventName:"languageSwitcher",commands:[{label:"".concat(e.CN),value:"cn"},{label:"".concat(e.EN),value:"en"}]};default:return}}},{key:"componentDidMount",value:function(){var e=this;f.on("gameSelect.newGame.click",(function(t){e.setState({commandBox:"newGame"})})),f.on("gameSelect.loadGame.click",(function(t){e.setState({commandBox:"loadGame"})})),f.on("gameSelect.languageSwitcher.click",(function(t){e.setState({commandBox:"languageSwitcher"})})),f.on("newGame.click",(function(t){f.trigger("scene.change",d.ROLE_SELECT),e.setState({commandBox:"main"})})),f.on("loadGame.click",(function(t){e.setState({commandBox:"main"})})),f.on("languageSwitcher.click",(function(t){t.value!==j.get()&&(j.set(t.value),f.trigger("lang.change",t.value)),e.setState({commandBox:"main"})}))}},{key:"render",value:function(){var e=this._getCommandBox();return i.a.createElement("div",{className:"game-select scene"},i.a.createElement(R,null),i.a.createElement("div",{className:"game-select-box"},i.a.createElement("div",{className:"command-box"},i.a.createElement(x,{args:e}))))}}]),t}(a.Component),I=(n(18),function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_init",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"role-select scene"})}}]),t}(a.Component)),D=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"main-map scene"},"Main Main")}}]),t}(a.Component),W=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={scene:0,lang:"cn"},n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"_getScene",value:function(e){var t=null;switch(this.state.scene){case d.GAME_SELECT:t=i.a.createElement(B,null);break;case d.ROLE_SELECT:t=i.a.createElement(I,null);break;case d.MAIN_MAP:t=i.a.createElement(D,null);break;case d.BATTLE_MAP:t=i.a.createElement("div",{id:"battle-map-scene"},"this is battle map");break;case d.BATTLE:t=i.a.createElement("div",{id:"battle-scene"},"this is battle");break;case d.END:t=i.a.createElement("div",{id:"end-scene"},"this is the end")}return t}},{key:"_init",value:function(){C.init(),this._toScene(d.ROLE_SELECT)}},{key:"_toScene",value:function(e){this.setState({scene:parseInt(e)})}},{key:"componentDidMount",value:function(){var e=this;this._init(),f.on("lang.change",(function(t){e.setState({lang:t})})),f.on("scene.change",(function(t){e.setState({scene:t})}))}},{key:"render",value:function(){if(!this.state.scene)return i.a.createElement("div",{id:"loading"},"Loading...");var e=this._getScene(this.state.scene);return i.a.createElement("div",{id:"game-wrapper",className:this.state.lang},e)}}]),t}(a.Component);var P=function(){return i.a.createElement("div",{id:"game"},i.a.createElement(W,null))},V=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function U(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(i.a.createElement(P,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");V?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):U(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):U(t,e)}))}}()}],[[8,1,2]]]);
//# sourceMappingURL=main.390e8ab3.chunk.js.map