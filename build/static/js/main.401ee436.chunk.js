(this.webpackJsonpthreekingdoms=this.webpackJsonpthreekingdoms||[]).push([[0],[,,,,,,function(e,n){},function(e,n){},,,,function(e,n,t){e.exports=t(22)},,,,,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var a=t(0),i=t.n(a),r=t(10),o=t.n(r),c=(t(16),t(17),t(1)),l=t(2),s=t(4),u=t(3),v=t(5),f=.01,h={GAME_SELECT:1,ROLE_SELECT:2,MAIN_MAP:3,BATTLE_MAP:4,BATTLE:5,END:6},m={armor:"armor.json",army:"army.json",city:"city.json",general:"general.json",kingdom:"kingdom.json",weapon:"weapon.json",weaponType:"weaponType.json",newGameCache:"newGameCache.json"};function d(){this.ipcRenderer=window.require("electron").ipcRenderer}d.prototype.save=function(e,n){return this.do("save",e,{data:n})},d.prototype.load=function(e){return this.do("load",e)},d.prototype.saveGame=function(e,n){return this.do("save",e,{db:"saveGame",data:n})},d.prototype.loadGame=function(e){return this.do("load",e,{db:"saveGame"})},d.prototype.loadSysDb=function(e){return this.do("load",e,{db:"sys"})},d.prototype.do=function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(i,r){n.ipcRenderer.once("".concat(t,".").concat(e,".complete"),(function(e,n){i(n)})),n.ipcRenderer.send(e,{fileName:t,opts:a})}))};var g=new d,y={pool:[],findEvent:function(e){for(var n=this.pool.length-1;n>=0;n--)if(this.pool[n].name===e)return this.pool[n];return!1},uniqueCallback:function(e,n){for(var t=!1,a=0;a<e.funcs.length;a++)if(n.toString()===e.funcs[a].toString()){e.funcs[a]=n,t=!0;break}t||e.funcs.push(n)},removeEvent:function(e){for(var n=this.pool.length-1;n>=0;n--)if(this.pool[n].name===e){this.pool.splice(n,1);break}},destory:function(e){this.removeEvent.call(this,e)},off:function(e){this.removeEvent.call(this,e)},unSubscribe:function(e){this.removeEvent.call(this,e)},once:function(e,n){var t=this.findEvent(e);t?n&&t.funcs.push(n):(t={name:e,funcs:[n],isOnce:!0},this.pool.push(t))},listen:function(e,n){var t=this.findEvent(e);t?this.uniqueCallback(t,n):(t={name:e,funcs:[n],isOnce:!1},this.pool.push(t))},on:function(e,n){this.listen.call(this,e,n)},subscribe:function(e,n){this.listen.call(this,e,n)},trigger:function(e,n){var t=this.findEvent(e);t&&(t.funcs.forEach((function(e){e(n)})),t.isOnce&&this.removeEvent(e))}},b=t(6),p=t.n(b),E=t(7),S=t.n(E),w=(p.a,S.a,t(8)),k=function(){function e(n){for(var t in Object(c.a)(this,e),n)this[t]=n[t]}return Object(l.a)(e,[{key:"build",value:function(){}}]),e}(),O=function(){function e(n){for(var t in Object(c.a)(this,e),n)this[t]=n[t]}return Object(l.a)(e,[{key:"build",value:function(){}},{key:"getMaxAllowedMilitary",value:function(e){this.maxMilitary=1e3*Math.round(this.command/10+1)}},{key:"getOverallForce",value:function(){}},{key:"getLevel",value:function(){}}]),e}(),A=function(){function e(n){for(var t in Object(c.a)(this,e),n)this[t]=n[t]}return Object(l.a)(e,[{key:"build",value:function(){}},{key:"getPopulation",value:function(){var e=Math.pow(.1*+this.entity.industry+.3*this.entity.infrastructure+10*this.entity.morale*.3,.57);return 1e4*Math.round(e)}},{key:"countMilitary",value:function(){}}]),e}(),j=function(){function e(n){for(var t in Object(c.a)(this,e),n)this[t]=n[t]}return Object(l.a)(e,[{key:"build",value:function(){}}]),e}(),L=function(){function e(n){for(var t in Object(c.a)(this,e),n)this[t]=n[t]}return Object(l.a)(e,[{key:"build",value:function(){}}]),e}(),_=function(){function e(n){for(var t in Object(c.a)(this,e),n)this[t]=n[t]}return Object(l.a)(e,[{key:"build",value:function(){}}]),e}(),N=new(function(){function e(){Object(c.a)(this,e),this.instances={}}return Object(l.a)(e,[{key:"init",value:function(){var e=this;return this.load().then((function(n){return e.build(n)}))}},{key:"createInstance",value:function(e,n){return e.map((function(e){return new n(e)}))}},{key:"build",value:function(e){this.instances={kingdoms:this.createInstance(e.kingdoms,k),generals:this.createInstance(e.generals,O),cities:this.createInstance(e.cities,A),weapons:this.createInstance(e.weapons,j),weaponTypes:this.createInstance(e.weaponTypes,L),armors:this.createInstance(e.armors,_)};var n=this.buildWeapons(this.instances.weapons,this.instances.weaponTypes),t=this.buildGenerals(this.instances.generals,this.instances.armors,n),a=this.buildCities(this.instances.cities,t);return this.buildKingdoms(this.instances.kingdoms,a)}},{key:"load",value:function(e){return Promise.all([g.load(m.kingdom),g.load(m.general),g.load(m.city),g.load(m.weapon),g.load(m.weaponType),g.load(m.armor)]).then((function(e){return{kingdoms:e[0],generals:e[1],cities:e[2],weapons:e[3],weaponTypes:e[4],armors:e[5]}}))}},{key:"buildWeapons",value:function(e,n){var t=!0,a=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var c=r.value,l=!0,s=!1,u=void 0;try{for(var v,f=n[Symbol.iterator]();!(l=(v=f.next()).done);l=!0){var h=v.value;c.category===h.id&&(c.category=h)}}catch(m){s=!0,u=m}finally{try{l||null==f.return||f.return()}finally{if(s)throw u}}}}catch(m){a=!0,i=m}finally{try{t||null==o.return||o.return()}finally{if(a)throw i}}return e}},{key:"buildGenerals",value:function(e,n,t){var a=!0,i=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var l=o.value,s=!0,u=!1,v=void 0;try{for(var f,h=t[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var m=f.value;l.weapon===m.id&&(l.weapon=m)}}catch(S){u=!0,v=S}finally{try{s||null==h.return||h.return()}finally{if(u)throw v}}var d=!0,g=!1,y=void 0;try{for(var b,p=n[Symbol.iterator]();!(d=(b=p.next()).done);d=!0){var E=b.value;l.armor===E.id&&(l.armor=E)}}catch(S){g=!0,y=S}finally{try{d||null==p.return||p.return()}finally{if(g)throw y}}}}catch(S){i=!0,r=S}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return e}},{key:"buildCities",value:function(e,n){var t=!0,a=!1,i=void 0;try{for(var r,o=n[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var c=r.value,l=!0,s=!1,u=void 0;try{for(var v,f=e[Symbol.iterator]();!(l=(v=f.next()).done);l=!0){var h=v.value;h.leader===c.id&&(h.leader=c);var m=!0,d=!1,g=void 0;try{for(var y,b=h.generals.entries()[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var p=y.value,E=Object(w.a)(p,2),S=E[0];E[1]===c.id&&(h.generals[S]=c)}}catch(k){d=!0,g=k}finally{try{m||null==b.return||b.return()}finally{if(d)throw g}}}}catch(k){s=!0,u=k}finally{try{l||null==f.return||f.return()}finally{if(s)throw u}}}}catch(k){a=!0,i=k}finally{try{t||null==o.return||o.return()}finally{if(a)throw i}}return e}},{key:"buildKingdoms",value:function(e,n){var t=!0,a=!1,i=void 0;try{for(var r,o=n[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var c=r.value,l=!0,s=!1,u=void 0;try{for(var v,f=e[Symbol.iterator]();!(l=(v=f.next()).done);l=!0){var h=v.value;h.capital===c.id&&(h.capital=c);var m=!0,d=!1,g=void 0;try{for(var y,b=h.cities.entries()[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var p=y.value,E=Object(w.a)(p,2),S=E[0];E[1]===c.id&&(h.cities[S]=c)}}catch(k){d=!0,g=k}finally{try{m||null==b.return||b.return()}finally{if(d)throw g}}}}catch(k){s=!0,u=k}finally{try{l||null==f.return||f.return()}finally{if(s)throw u}}}}catch(k){a=!0,i=k}finally{try{t||null==o.return||o.return()}finally{if(a)throw i}}return e}}]),e}());function T(){this.gameDataCache={}}T.prototype.init=function(){var e=this;N.init().then((function(n){e.gameDataCache.data=n,console.log(e.gameDataCache)}))};var C=new T,G={gameSelectScene:{GAME_TITLE:"Three Kingdoms",GAME_VERSION:"version",NEW_GAME:"New Game",LOAD_SAVED:"Load Game",LANGUAGE_SWITCHER:"Language",CN:"Chinese",EN:"English",DIFFICULT:"Difficulty",EASY:"Easy",NORMAL:"Normal",HARD:"Hard",BACK:"Back",SAVE_SLOT:"Save Slot"}},M={gameSelectScene:{GAME_TITLE:"\u4e09\u56fd\u5fd7",GAME_VERSION:"\u7248\u672c",NEW_GAME:"\u65b0\u6e38\u620f",LOAD_SAVED:"\u8bfb\u53d6\u8fdb\u5ea6",LANGUAGE_SWITCHER:"\u5207\u6362\u8bed\u8a00",CN:"\u4e2d\u6587",EN:"\u82f1\u8bed",DIFFICULT:"\u96be\u5ea6",EASY:"\u7b80\u5355",NORMAL:"\u4e00\u822c",HARD:"\u56f0\u96be",BACK:"\u540e\u9000",SAVE_SLOT:"\u5b58\u6863"}},x={currentLanguage:"cn",content:M,set:function(e){switch(e.toLowerCase()){case"en":this.currentLanguage="en",this.content=G;break;case"cn":this.currentLanguage="cn",this.content=M;break;default:throw new Error("unrecognized language code in Language Class")}},get:function(){return this.currentLanguage}},I=function(e){function n(e){var t;return Object(c.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).state={scene:0,lang:"cn"},t}return Object(v.a)(n,e),Object(l.a)(n,[{key:"_getScene",value:function(e){var n=null;switch(this.state.scene){case h.GAME_SELECT:n=i.a.createElement(D,null);break;case h.ROLE_SELECT:n=i.a.createElement(W,null);break;case h.MAIN_MAP:n=i.a.createElement(V,null);break;case h.BATTLE_MAP:n=i.a.createElement("div",{id:"battle-map-scene"},"this is battle map");break;case h.BATTLE:n=i.a.createElement("div",{id:"battle-scene"},"this is battle");break;case h.END:n=i.a.createElement("div",{id:"end-scene"},"this is the end")}return n}},{key:"_init",value:function(){C.init(),x.set("cn"),this._toScene(h.ROLE_SELECT)}},{key:"_toScene",value:function(e){this.setState({scene:parseInt(e)})}},{key:"componentDidMount",value:function(){var e=this;this._init(),y.on("lang.change",(function(n){e.setState({lang:n})})),y.on("scene.change",(function(n){e.setState({scene:n})}))}},{key:"render",value:function(){if(!this.state.scene)return i.a.createElement("div",{id:"loading"},"Loading...");var e=this._getScene(this.state.scene);return i.a.createElement("div",{id:"game-wrapper",className:this.state.lang},e)}}]),n}(a.Component),R=(t(18),t(19),function(e){function n(){return Object(c.a)(this,n),Object(s.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(v.a)(n,e),Object(l.a)(n,[{key:"_getLayout",value:function(){var e=this,n=[];return this.props.args.commands.forEach((function(t,a){n.push(i.a.createElement("li",{key:a,className:"command"},i.a.createElement("button",{"data-value":t.value,className:"command-btn ".concat(t.value),onClick:e._clickCommand.bind(e,t)},t.label)))})),n}},{key:"_clickCommand",value:function(e){y.trigger("".concat(this.props.args.eventName,".click"),e),y.trigger("".concat(this.props.args.eventName,".").concat(e.value,".click"),e)}},{key:"render",value:function(){var e=this._getLayout(),n=this.props.args.heading?i.a.createElement("h3",{className:"heading"},this.props.args.heading):"";return i.a.createElement("div",{className:"cp cp-command-box ".concat(this.props.args.eventName)},n,i.a.createElement("ul",null,e))}}]),n}(a.Component)),B=(t(20),function(e){function n(){return Object(c.a)(this,n),Object(s.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(v.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){var e=x.content.gameSelectScene;return i.a.createElement("div",{className:"cp cp-game-select-banner"},i.a.createElement("h1",{className:"primary-text"},e.GAME_TITLE),i.a.createElement("span",{className:"game-version"},e.GAME_VERSION," ",f))}}]),n}(a.Component)),D=function(e){function n(e){var t;return Object(c.a)(this,n),(t=Object(s.a)(this,Object(u.a)(n).call(this,e))).state={commandBox:"main"},t}return Object(v.a)(n,e),Object(l.a)(n,[{key:"_getCommandBox",value:function(){var e=x.content.gameSelectScene;switch(this.state.commandBox){case"main":return{eventName:"gameSelect",commands:[{label:e.NEW_GAME,value:"newGame"},{label:e.LOAD_SAVED,value:"loadGame"},{label:e.LANGUAGE_SWITCHER,value:"languageSwitcher"}]};case"newGame":return{eventName:"newGame",commands:[{label:e.EASY,value:"level1"},{label:e.NORMAL,value:"level2"},{label:e.HARD,value:"level3"},{label:e.BACK,value:"back"}]};case"loadGame":return{eventName:"loadGame",commands:[{label:"".concat(e.SAVE_SLOT," 1"),value:"save1"},{label:"".concat(e.SAVE_SLOT," 2"),value:"save2"},{label:"".concat(e.SAVE_SLOT," 3"),value:"save3"},{label:"".concat(e.SAVE_SLOT," 4"),value:"save4"},{label:"".concat(e.SAVE_SLOT," 5"),value:"save5"},{label:"".concat(e.SAVE_SLOT," 6"),value:"save6"},{label:"".concat(e.SAVE_SLOT," 7"),value:"save7"},{label:"".concat(e.SAVE_SLOT," 8"),value:"save8"}]};case"languageSwitcher":return{eventName:"languageSwitcher",commands:[{label:"".concat(e.CN),value:"cn"},{label:"".concat(e.EN),value:"en"}]};default:return}}},{key:"componentDidMount",value:function(){var e=this;y.on("gameSelect.newGame.click",(function(n){e.setState({commandBox:"newGame"})})),y.on("gameSelect.loadGame.click",(function(n){e.setState({commandBox:"loadGame"})})),y.on("gameSelect.languageSwitcher.click",(function(n){e.setState({commandBox:"languageSwitcher"})})),y.on("newGame.click",(function(n){y.trigger("scene.change",h.ROLE_SELECT),e.setState({commandBox:"main"})})),y.on("loadGame.click",(function(n){e.setState({commandBox:"main"})})),y.on("languageSwitcher.click",(function(n){n.value!==x.get()&&(x.set(n.value),y.trigger("lang.change",n.value)),e.setState({commandBox:"main"})}))}},{key:"render",value:function(){var e=this._getCommandBox();return i.a.createElement("div",{className:"game-select scene"},i.a.createElement(B,null),i.a.createElement("div",{className:"game-select-box"},i.a.createElement("div",{className:"command-box"},i.a.createElement(R,{args:e}))))}}]),n}(a.Component),V=function(e){function n(){return Object(c.a)(this,n),Object(s.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(v.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"main-map scene"},"Main Main")}}]),n}(a.Component),W=(t(21),function(e){function n(){return Object(c.a)(this,n),Object(s.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(v.a)(n,e),Object(l.a)(n,[{key:"_init",value:function(){}},{key:"render",value:function(){return i.a.createElement("div",{className:"role-select scene"})}}]),n}(a.Component));var P=function(){return i.a.createElement("div",{id:"game"},i.a.createElement(I,null))},U=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function H(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(i.a.createElement(P,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat(".","/service-worker.js");U?(!function(e,n){fetch(e).then((function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):H(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):H(n,e)}))}}()}],[[11,1,2]]]);
//# sourceMappingURL=main.401ee436.chunk.js.map